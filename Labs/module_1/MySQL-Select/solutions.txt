

-- WEEK 2 LAB - MySQL - select -- 

#CHALLENGE 1 

select * from authors;
select * from titles;
select * from titleauthor; 
select * from publishers;


select a.`au_id`, a.au_lname, a.au_fname, p.pub_name, t.`title`
from `authors` a
inner join titleauthor ta on a.au_id = ta.au_id
inner join titles t on t.title_id = ta.title_id
inner join publishers p on t.pub_id = p.pub_id;


#CHALLENGE 2

select a.`au_id`, a.au_lname, a.au_fname, count(t.title) as nb_of_books, p.pub_name
from `authors` a
inner join titleauthor ta on a.au_id = ta.au_id
inner join titles t on t.title_id = ta.title_id
inner join publishers p on t.pub_id = p.pub_id
group by a.`au_id`, p.pub_name
order by nbpub desc;


#CHALLENGE 3

select a.`au_id`, a.au_lname, a.au_fname, sum(t.ytd_sales) as total
from `authors` a
inner join titleauthor ta on a.au_id = ta.au_id
inner join titles t on t.title_id = ta.title_id
inner join publishers p on t.pub_id = p.pub_id
group by a.au_id 
order by total desc
limit 3;


#CHALLENGE 4

select a.`au_id`, a.au_lname, a.au_fname, ifnull(sum(t.ytd_sales),0) as total
from `authors` a
inner join titleauthor ta on a.au_id = ta.au_id
inner join titles t on t.title_id = ta.title_id
inner join publishers p on t.pub_id = p.pub_id
group by a.au_id 
order by total desc;


